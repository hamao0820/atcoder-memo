---
title: C - HSI
tags:
  - 期待値
---

# C - HSI

## キーワード

import Tag from "components/Tag";

- <Tag tag="期待値" />

## 解説

[問題](https://atcoder.jp/contests/abc078/tasks/arc085_a)

問題数 $n$ と、TLE 問題数 $m$ が与えられる。毎回、採点終了までにかかる時間は、

$$
1900m + 100(n-m) = 100n + 1800m
$$

である。

また、AC する確率は $2^{-m}$ であり、$i$ 回目で初めて AC する確率は $p_i = 2^{-m}(1-2^{-m})^{i-1}$ である。

よって、$i$ 回目で初めて AC する確率を $p_i$ とすると、採点終了までにかかる時間の期待値は、

$$
\begin{align*}
E &= \sum_{i=1}^{\infty} i(100n + 1800m)p_i \\
&= (100n + 1800m)\sum_{i=1}^{\infty} ip_i \\
&= (100n + 1800m)\sum_{i=1}^{\infty} i2^{-m}(1-2^{-m})^{i-1} \\
&= (100n + 1800m)2^{-m} \lim_{k \to \infty} \sum_{i=1}^{k} i(1-2^{-m})^{i-1}
\end{align*}
$$

ここで、$S_k = \sum_{i=1}^{k} i(1-2^{-m})^{i-1}$ とすると、

$$
\begin{align*}
S_k &= 1 + 2(1-2^{-m}) + 3(1-2^{-m})^2 + \cdots + k(1-2^{-m})^{k-1} \\
(1-2^{-m})S_k &= (1-2^{-m}) + 2(1-2^{-m})^2 + 3(1-2^{-m})^3 + \cdots + (k-1)(1-2^{-m})^{k-1} + k(1-2^{-m})^k \\
S_k - (1-2^{-m})S_k &= 1 + (1-2^{-m}) + (1-2^{-m})^2 + (1-2^{-m})^3 + \cdots + (1-2^{-m})^{k-1} - k(1-2^{-m})^k \\
&= \frac{1 - (1-2^{-m})^k}{1-(1-2^{-m})} - k(1-2^{-m})^k \\
&= \frac{1 - (1-2^{-m})^k - 2^{-m}k(1-2^{-m})^k}{2^{-m}} \\
S_k &= \frac{1 - (1-2^{-m})^k - 2^{-m}k(1-2^{-m})^k}{2^{-2m}} \\
\end{align*}
$$

より、

$$
\begin{align*}
E &= (100n + 1800m)2^{-m} \lim_{k \to \infty} S_k \\
&= (100n + 1800m)2^{-m} \lim_{k \to \infty} \frac{1 - (1-2^{-m})^k - 2^{-m}k(1-2^{-m})^k}{2^{-2m}} \\
&= (100n + 1800m)2^{-m} \frac{1}{2^{-2m}} \\
&= (100n + 1800m)2^{-m}2^{2m} \\
&= (100n + 1800m)2^{m} \\
\end{align*}
$$

一般に、「有効なのが来るまでカードを引く期待値は、有効なカードを引く確率の逆数になる。」という性質がある。

## 提出コード

```go
func main() {
	var n, m int
	scanIntVariables(&n, &m)
	ans := (100*n + 1800*m) * pow(2, m)
	writeLine(ans)
}
```
